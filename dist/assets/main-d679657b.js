/* empty css             */!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();window.telegramService=new class{constructor(){var t;this.tg=null==(t=window.Telegram)?void 0:t.WebApp,this.isReady=!1,this.user=null,this.initData=null,this.init()}init(){var t;if(this.tg)try{this.tg.ready(),this.tg.expand(),this.user=null==(t=this.tg.initDataUnsafe)?void 0:t.user,this.initData=this.tg.initData,this.setupTheme(),this.setupBackButton(),this.setupMainButton(),this.isReady=!0}catch(e){}}setupTheme(){if(!this.tg)return;const t=this.tg.colorScheme;if(document.documentElement.setAttribute("data-theme",t),this.tg.themeParams){const t=document.documentElement,e=this.tg.themeParams;e.bg_color&&t.style.setProperty("--tg-theme-bg-color",e.bg_color),e.text_color&&t.style.setProperty("--tg-theme-text-color",e.text_color),e.hint_color&&t.style.setProperty("--tg-theme-hint-color",e.hint_color),e.link_color&&t.style.setProperty("--tg-theme-link-color",e.link_color),e.button_color&&t.style.setProperty("--tg-theme-button-color",e.button_color),e.button_text_color&&t.style.setProperty("--tg-theme-button-text-color",e.button_text_color),e.secondary_bg_color&&t.style.setProperty("--tg-theme-secondary-bg-color",e.secondary_bg_color)}}setupBackButton(){var t;(null==(t=this.tg)?void 0:t.BackButton)&&this.tg.BackButton.onClick(()=>{this.handleBackButton()})}setupMainButton(){var t;(null==(t=this.tg)?void 0:t.MainButton)&&(this.tg.MainButton.setText("Continue"),this.tg.MainButton.color="#2481cc",this.tg.MainButton.textColor="#ffffff",this.tg.MainButton.onClick(()=>{this.handleMainButton()}))}handleBackButton(){var t;switch(this.getCurrentView()){case"transactions":case"analytics":this.showMainView();break;default:null==(t=this.tg)||t.close()}}handleMainButton(){var t;switch(this.getCurrentView()){case"capture-payment":this.submitPayment();break;case"upload-statement":this.submitStatement();break;default:null==(t=this.tg)||t.close()}}getCurrentView(){var t,e,n,a;return"none"!==(null==(t=document.getElementById("transactions-view"))?void 0:t.style.display)?"transactions":"none"!==(null==(e=document.getElementById("analytics-view"))?void 0:e.style.display)?"analytics":"none"!==(null==(n=document.getElementById("capture-view"))?void 0:n.style.display)?"capture-payment":"none"!==(null==(a=document.getElementById("upload-view"))?void 0:a.style.display)?"upload-statement":"main"}showBackButton(){var t;(null==(t=this.tg)?void 0:t.BackButton)&&this.tg.BackButton.show()}hideBackButton(){var t;(null==(t=this.tg)?void 0:t.BackButton)&&this.tg.BackButton.hide()}showMainButton(t="Continue"){var e;(null==(e=this.tg)?void 0:e.MainButton)&&(this.tg.MainButton.setText(t),this.tg.MainButton.show())}hideMainButton(){var t;(null==(t=this.tg)?void 0:t.MainButton)&&this.tg.MainButton.hide()}showPopup(t){var e;return(null==(e=this.tg)?void 0:e.showPopup)?new Promise(e=>{this.tg.showPopup(t,t=>{e(t)})}):Promise.resolve(null)}showAlert(t){var e;(null==(e=this.tg)?void 0:e.showAlert)?this.tg.showAlert(t):alert(t)}showConfirm(t){var e;return(null==(e=this.tg)?void 0:e.showConfirm)?new Promise(e=>{this.tg.showConfirm(t,t=>{e(t)})}):Promise.resolve(confirm(t))}sendData(t){var e;(null==(e=this.tg)?void 0:e.sendData)&&this.tg.sendData(JSON.stringify(t))}close(){var t;(null==(t=this.tg)?void 0:t.close)&&this.tg.close()}getUser(){return this.user}getUserId(){var t;return null==(t=this.user)?void 0:t.id}getUserName(){var t;return(null==(t=this.user)?void 0:t.first_name)||"User"}getUserAvatar(){var t;return null==(t=this.user)?void 0:t.photo_url}getInitData(){return this.initData}isTelegram(){return!!this.tg}getPlatform(){var t;return(null==(t=this.tg)?void 0:t.platform)||"unknown"}getVersion(){var t;return(null==(t=this.tg)?void 0:t.version)||"unknown"}isExpanded(){var t;return(null==(t=this.tg)?void 0:t.isExpanded)||!1}getViewportHeight(){var t;return(null==(t=this.tg)?void 0:t.viewportHeight)||window.innerHeight}getViewportStableHeight(){var t;return(null==(t=this.tg)?void 0:t.viewportStableHeight)||window.innerHeight}impactOccurred(t="medium"){var e,n;(null==(n=null==(e=this.tg)?void 0:e.HapticFeedback)?void 0:n.impactOccurred)&&this.tg.HapticFeedback.impactOccurred(t)}notificationOccurred(t="success"){var e,n;(null==(n=null==(e=this.tg)?void 0:e.HapticFeedback)?void 0:n.notificationOccurred)&&this.tg.HapticFeedback.notificationOccurred(t)}selectionChanged(){var t,e;(null==(e=null==(t=this.tg)?void 0:t.HapticFeedback)?void 0:e.selectionChanged)&&this.tg.HapticFeedback.selectionChanged()}};const t=window.telegramService;class e{constructor(){this.baseUrl=this.getBaseUrl(),this.timeout=1e4}getBaseUrl(){return"https://api.veripay.com"}async request(e,n={}){const a=`${this.baseUrl}${e}`,r={...{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t.getInitData()}`,"X-User-ID":t.getUserId(),"X-Platform":"telegram-mini-app"},timeout:this.timeout},...n};try{const t=new AbortController,e=setTimeout(()=>t.abort(),this.timeout),n=await fetch(a,{...r,signal:t.signal});if(clearTimeout(e),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(s){throw this.handleError(s)}}handleError(t){return"AbortError"===t.name?new Error("Request timeout. Please check your connection."):t.message.includes("Failed to fetch")?new Error("Network error. Please check your connection."):t}async getTransactions(t={}){try{const e=new URLSearchParams({limit:t.limit||20,offset:t.offset||0,...t});return await this.request(`/api/transactions?${e}`)}catch(e){throw e}}async getTransaction(t){try{return await this.request(`/api/transactions/${t}`)}catch(e){throw e}}async createTransaction(t){try{return await this.request("/api/transactions",{method:"POST",body:JSON.stringify(t)})}catch(e){throw e}}async getUserProfile(){try{return await this.request("/api/user/profile")}catch(t){throw t}}async updateUserProfile(t){try{return await this.request("/api/user/profile",{method:"PUT",body:JSON.stringify(t)})}catch(e){throw e}}async getAnalytics(t={}){try{const e=new URLSearchParams({period:t.period||"week",...t});return await this.request(`/api/analytics?${e}`)}catch(e){throw e}}async getDashboardData(){try{return await this.request("/api/dashboard")}catch(t){throw t}}async uploadFile(e,n="receipt"){try{const a=new FormData;return a.append("file",e),a.append("type",n),a.append("user_id",t.getUserId()),await this.request("/api/upload",{method:"POST",headers:{Authorization:`Bearer ${t.getInitData()}`},body:a})}catch(a){throw a}}async uploadStatement(t){try{return await this.uploadFile(t,"statement")}catch(e){throw e}}async processStatement(t){try{return await this.request(`/api/statements/${t}/process`,{method:"POST"})}catch(e){throw e}}async getReconciliationData(t={}){try{const e=new URLSearchParams(t);return await this.request(`/api/reconciliation?${e}`)}catch(e){throw e}}async performReconciliation(t){try{return await this.request("/api/reconciliation",{method:"POST",body:JSON.stringify(t)})}catch(e){throw e}}async getNotifications(t={}){try{const e=new URLSearchParams({unread_only:t.unread_only||!1,...t});return await this.request(`/api/notifications?${e}`)}catch(e){throw e}}async markNotificationAsRead(t){try{return await this.request(`/api/notifications/${t}/read`,{method:"PUT"})}catch(e){throw e}}async healthCheck(){try{return await this.request("/api/health")}catch(t){throw t}}getMockTransactions(){return[{id:1,amount:150,bank_name:"CBE",receipt_number:"CBE123456789",created_at:new Date(Date.now()-72e5).toISOString(),status:"completed",customer_name:"John Doe"},{id:2,amount:75.5,bank_name:"Telebirr",receipt_number:"TB987654321",created_at:new Date(Date.now()-18e6).toISOString(),status:"completed",customer_name:"Jane Smith"},{id:3,amount:200,bank_name:"Dashen Bank",receipt_number:"DB456789123",created_at:new Date(Date.now()-864e5).toISOString(),status:"pending",customer_name:"Bob Johnson"}]}getMockAnalytics(){return{total_transactions:45,total_amount:6750.5,today_transactions:8,today_amount:1200,weekly_chart:[{day:"Mon",amount:450,count:3},{day:"Tue",amount:320.5,count:2},{day:"Wed",amount:680,count:4},{day:"Thu",amount:290,count:2},{day:"Fri",amount:560,count:3},{day:"Sat",amount:890,count:5},{day:"Sun",amount:1200,count:8}],bank_breakdown:[{bank:"CBE",amount:2500,percentage:37},{bank:"Telebirr",amount:1800.5,percentage:27},{bank:"Dashen Bank",amount:1450,percentage:21},{bank:"Other",amount:1e3,percentage:15}]}}}class n{constructor(){this.prefix="veripay_",this.encryptionKey="veripay_secure_key"}set(t,e,n=!1){try{const a=n?this.encrypt(JSON.stringify(e)):JSON.stringify(e);return localStorage.setItem(this.prefix+t,a),!0}catch(a){return!1}}get(t,e=!1){try{const n=localStorage.getItem(this.prefix+t);if(!n)return null;return e?JSON.parse(this.decrypt(n)):JSON.parse(n)}catch(n){return null}}remove(t){try{return localStorage.removeItem(this.prefix+t),!0}catch(e){return!1}}clear(){try{return Object.keys(localStorage).filter(t=>t.startsWith(this.prefix)).forEach(t=>localStorage.removeItem(t)),!0}catch(t){return!1}}setUser(t){return this.set("user",t,!0)}getUser(){return this.get("user",!0)}removeUser(){return this.remove("user")}setTheme(t){return this.set("theme",t)}getTheme(){return this.get("theme")||"light"}setTransactions(t){return this.set("transactions",t)}getTransactions(){return this.get("transactions")||[]}addTransaction(t){const e=this.getTransactions();return e.unshift(t),this.setTransactions(e.slice(0,50))}setAnalytics(t){return this.set("analytics",t)}getAnalytics(){return this.get("analytics")}setSettings(t){return this.set("settings",t)}getSettings(){return this.get("settings")||{notifications:!0,haptic_feedback:!0,auto_refresh:!0,theme:"auto"}}updateSetting(t,e){const n=this.getSettings();return n[t]=e,this.setSettings(n)}setCache(t,e,n=3e5){const a={data:e,timestamp:Date.now(),ttl:n};return this.set(`cache_${t}`,a)}getCache(t){const e=this.get(`cache_${t}`);if(!e)return null;return Date.now()-e.timestamp>e.ttl?(this.remove(`cache_${t}`),null):e.data}clearCache(){try{return Object.keys(localStorage).filter(t=>t.startsWith(this.prefix+"cache_")).forEach(t=>localStorage.removeItem(t)),!0}catch(t){return!1}}setOfflineData(t,e){return this.set(`offline_${t}`,e)}getOfflineData(t){return this.get(`offline_${t}`)}addToSyncQueue(t){const e=this.getSyncQueue();return e.push({...t,id:Date.now()+Math.random(),timestamp:Date.now()}),this.set("sync_queue",e)}getSyncQueue(){return this.get("sync_queue")||[]}removeFromSyncQueue(t){const e=this.getSyncQueue().filter(e=>e.id!==t);return this.set("sync_queue",e)}clearSyncQueue(){return this.remove("sync_queue")}encrypt(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t.charCodeAt(n)^this.encryptionKey.charCodeAt(n%this.encryptionKey.length));return btoa(e)}decrypt(t){try{const e=atob(t);let n="";for(let t=0;t<e.length;t++)n+=String.fromCharCode(e.charCodeAt(t)^this.encryptionKey.charCodeAt(t%this.encryptionKey.length));return n}catch(e){return null}}getStorageUsage(){try{let t=0;for(let e in localStorage)e.startsWith(this.prefix)&&(t+=localStorage[e].length);return{used:t,usedKB:Math.round(t/1024*100)/100,usedMB:Math.round(t/1024/1024*100)/100}}catch(t){return{used:0,usedKB:0,usedMB:0}}}cleanup(){try{const t=Date.now(),e=6048e5;return Object.keys(localStorage).filter(t=>t.startsWith(this.prefix+"cache_")).forEach(n=>{const a=this.get(n.replace(this.prefix,""));a&&t-a.timestamp>e&&localStorage.removeItem(n)}),!0}catch(t){return!1}}exportData(){try{const t={};return Object.keys(localStorage).filter(t=>t.startsWith(this.prefix)).forEach(e=>{t[e]=localStorage.getItem(e)}),JSON.stringify(t,null,2)}catch(t){return null}}importData(t){try{const e=JSON.parse(t);return Object.keys(e).forEach(t=>{t.startsWith(this.prefix)&&localStorage.setItem(t,e[t])}),!0}catch(e){return!1}}}class a{constructor(){this.api=new e,this.storage=new n,this.currentView="main",this.user=null,this.transactions=[],this.init()}async init(){try{await this.waitForTelegram(),await this.initializeUser(),this.setupEventListeners(),await this.loadInitialData(),this.showApp()}catch(t){this.showError("Failed to initialize app. Please try again.")}}async waitForTelegram(){return new Promise(e=>{const n=()=>{t.isReady?e():setTimeout(n,100)};n()})}async initializeUser(){this.user=t.getUser(),this.user&&(this.updateUserInfo(),this.storage.setUser(this.user))}updateUserInfo(){var t;const e=document.getElementById("user-name"),n=document.getElementById("user-role"),a=document.getElementById("user-avatar");e&&this.user&&(e.textContent=`Welcome, ${this.user.first_name||"User"}!`),n&&(n.textContent="Waiter"),a&&(null==(t=this.user)?void 0:t.first_name)&&(a.textContent=this.user.first_name.charAt(0).toUpperCase())}setupEventListeners(){var t,e,n,a,r,s,i;null==(t=document.getElementById("capture-payment-btn"))||t.addEventListener("click",()=>{this.showCapturePayment()}),null==(e=document.getElementById("view-transactions-btn"))||e.addEventListener("click",()=>{this.showTransactions()}),null==(n=document.getElementById("upload-statement-btn"))||n.addEventListener("click",()=>{this.showUploadStatement()}),null==(a=document.getElementById("analytics-btn"))||a.addEventListener("click",()=>{this.showAnalytics()}),null==(r=document.getElementById("view-all-btn"))||r.addEventListener("click",()=>{this.showTransactions()}),null==(s=document.getElementById("theme-toggle"))||s.addEventListener("click",()=>{this.toggleTheme()}),null==(i=document.getElementById("settings-btn"))||i.addEventListener("click",()=>{this.showSettings()})}async loadInitialData(){try{await this.loadRecentTransactions(),this.loadUserPreferences()}catch(t){}}async loadRecentTransactions(){try{const t=await this.api.getTransactions({limit:5});t&&t.length>0?(this.transactions=t,this.renderRecentTransactions()):this.loadMockTransactions()}catch(t){this.loadMockTransactions()}}loadMockTransactions(){this.transactions=[{id:1,amount:150,bank_name:"CBE",receipt_number:"CBE123456789",created_at:new Date(Date.now()-72e5).toISOString(),status:"completed"},{id:2,amount:75.5,bank_name:"Telebirr",receipt_number:"TB987654321",created_at:new Date(Date.now()-18e6).toISOString(),status:"completed"},{id:3,amount:200,bank_name:"Dashen Bank",receipt_number:"DB456789123",created_at:new Date(Date.now()-864e5).toISOString(),status:"pending"}],this.renderRecentTransactions()}renderRecentTransactions(){const t=document.getElementById("recent-transactions");t&&(0!==this.transactions.length?t.innerHTML=this.transactions.map(t=>`\n      <div class="transaction-card animate-slide-up">\n        <div class="flex items-center justify-between">\n          <div class="flex-1">\n            <div class="flex items-center space-x-3">\n              <div class="w-10 h-10 bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg flex items-center justify-center">\n                <span class="text-white font-semibold text-sm">${t.bank_name.charAt(0)}</span>\n              </div>\n              <div class="flex-1">\n                <div class="font-semibold text-secondary-900">${function(t,e="ETB"){return"number"!=typeof t&&(t=parseFloat(t)||0),new Intl.NumberFormat("en-ET",{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}(t.amount)} ETB</div>\n                <div class="text-sm text-secondary-600">${t.bank_name}</div>\n              </div>\n            </div>\n          </div>\n          <div class="text-right">\n            <div class="text-xs text-secondary-500">${function(t,e={}){if(!t)return"N/A";const n=new Date(t);return isNaN(n.getTime())?"Invalid Time":new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0,...e}).format(n)}(t.created_at)}</div>\n            <div class="status-indicator ${"completed"===t.status?"status-success":"status-pending"}">\n              ${t.status}\n            </div>\n          </div>\n        </div>\n        <div class="mt-2 text-xs text-secondary-500">\n          Ref: ${t.receipt_number}\n        </div>\n      </div>\n    `).join(""):t.innerHTML='\n        <div class="text-center py-8 text-secondary-500">\n          <svg class="w-12 h-12 mx-auto mb-4 text-secondary-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>\n          </svg>\n          <p>No transactions yet</p>\n          <p class="text-sm">Start capturing payments to see them here</p>\n        </div>\n      ')}showApp(){const t=document.getElementById("loading-screen"),e=document.getElementById("app");t&&(t.style.display="none"),e&&(e.style.opacity="1")}showCapturePayment(){var e;t.impactOccurred("medium"),t.sendData({action:"capture_payment",user_id:null==(e=this.user)?void 0:e.id}),this.showToast("Opening payment capture...","info")}showTransactions(){var e;t.impactOccurred("light"),this.currentView="transactions",t.sendData({action:"view_transactions",user_id:null==(e=this.user)?void 0:e.id}),this.showToast("Loading transactions...","info")}showUploadStatement(){var e;t.impactOccurred("medium"),t.sendData({action:"upload_statement",user_id:null==(e=this.user)?void 0:e.id}),this.showToast("Opening statement upload...","info")}showAnalytics(){var e;t.impactOccurred("light"),t.sendData({action:"view_analytics",user_id:null==(e=this.user)?void 0:e.id}),this.showToast("Loading analytics...","info")}showSettings(){t.impactOccurred("light"),t.showPopup({title:"Settings",message:"Settings panel coming soon!",buttons:[{id:"ok",type:"default",text:"OK"}]})}toggleTheme(){t.impactOccurred("light");const e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";document.documentElement.setAttribute("data-theme",e),this.storage.setTheme(e),this.showToast(`Switched to ${e} theme`,"success")}loadUserPreferences(){const t=this.storage.getTheme();t&&document.documentElement.setAttribute("data-theme",t)}showToast(t,e="info"){const n=document.createElement("div");n.className="fixed top-20 left-4 right-4 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 translate-y-0 opacity-100";const a={success:"bg-green-500 text-white",error:"bg-red-500 text-white",warning:"bg-yellow-500 text-white",info:"bg-blue-500 text-white"};n.className+=` ${a[e]||a.info}`,n.textContent=t,document.body.appendChild(n),setTimeout(()=>{n.style.transform="translateY(-100px)",n.style.opacity="0",setTimeout(()=>{document.body.removeChild(n)},300)},3e3)}showError(t){this.showToast(t,"error")}showMainView(){this.currentView="main",t.hideBackButton(),t.hideMainButton()}}document.addEventListener("DOMContentLoaded",()=>{window.veriPayApp=new a});
//# sourceMappingURL=main-d679657b.js.map
