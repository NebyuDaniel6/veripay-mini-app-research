{"version":3,"file":"main-24a7095b.js","sources":["../../src/app.js"],"sourcesContent":["/**\n * VeriPay Mini App - Simple Working Version\n * Fixed UI and button functionality\n */\n\n// Simple Telegram service\nconst telegramService = {\n  init() {\n    if (window.Telegram && window.Telegram.WebApp) {\n      window.Telegram.WebApp.ready();\n      window.Telegram.WebApp.expand();\n      console.log('Telegram WebApp initialized');\n    } else {\n      console.warn('Telegram WebApp not available');\n    }\n  },\n\n  getUser() {\n    if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {\n      return window.Telegram.WebApp.initDataUnsafe.user;\n    }\n    return null;\n  },\n\n  sendData(data) {\n    if (window.Telegram && window.Telegram.WebApp) {\n      window.Telegram.WebApp.sendData(JSON.stringify(data));\n    }\n  },\n\n  showAlert(message) {\n    if (window.Telegram && window.Telegram.WebApp) {\n      window.Telegram.WebApp.showAlert(message);\n    } else {\n      alert(message);\n    }\n  }\n};\n\n// Simple formatters\nconst formatters = {\n  formatCurrency(amount) {\n    return new Intl.NumberFormat('en-US', {\n      style: 'currency',\n      currency: 'ETB',\n      minimumFractionDigits: 2\n    }).format(amount);\n  },\n\n  formatTimeAgo(timestamp) {\n    const now = Date.now();\n    const seconds = Math.round((now - timestamp) / 1000);\n    const minutes = Math.round(seconds / 60);\n    const hours = Math.round(minutes / 60);\n    const days = Math.round(hours / 24);\n\n    if (seconds < 60) return `${seconds}s ago`;\n    if (minutes < 60) return `${minutes}m ago`;\n    if (hours < 24) return `${hours}h ago`;\n    if (days < 30) return `${days}d ago`;\n    return new Date(timestamp).toLocaleDateString();\n  }\n};\n\n// Main App Class\nclass VeriPayApp {\n  constructor() {\n    this.user = null;\n    this.transactions = [];\n    this.init();\n  }\n\n  init() {\n    // Initialize Telegram\n    telegramService.init();\n    \n    // Get user data\n    this.user = telegramService.getUser();\n    \n    // Set up event listeners\n    this.setupEventListeners();\n    \n    // Update UI\n    this.updateUI();\n    \n    // Hide loading screen\n    this.hideLoadingScreen();\n    \n    console.log('VeriPay App initialized');\n  }\n\n  setupEventListeners() {\n    // Quick action buttons\n    const captureBtn = document.getElementById('capture-payment-btn');\n    const transactionsBtn = document.getElementById('view-transactions-btn');\n    const uploadBtn = document.getElementById('upload-statement-btn');\n    const analyticsBtn = document.getElementById('analytics-btn');\n\n    if (captureBtn) {\n      captureBtn.addEventListener('click', () => this.handleCapturePayment());\n    }\n\n    if (transactionsBtn) {\n      transactionsBtn.addEventListener('click', () => this.handleViewTransactions());\n    }\n\n    if (uploadBtn) {\n      uploadBtn.addEventListener('click', () => this.handleUploadStatement());\n    }\n\n    if (analyticsBtn) {\n      analyticsBtn.addEventListener('click', () => this.handleAnalytics());\n    }\n\n    // Bottom navigation\n    const homeBtn = document.getElementById('home-btn');\n    const transactionsNavBtn = document.getElementById('transactions-nav-btn');\n    const profileBtn = document.getElementById('profile-btn');\n\n    if (homeBtn) {\n      homeBtn.addEventListener('click', () => this.showHome());\n    }\n\n    if (transactionsNavBtn) {\n      transactionsNavBtn.addEventListener('click', () => this.handleViewTransactions());\n    }\n\n    if (profileBtn) {\n      profileBtn.addEventListener('click', () => this.showProfile());\n    }\n  }\n\n  updateUI() {\n    // Update user info\n    this.updateUserInfo();\n    \n    // Load sample transactions\n    this.loadSampleTransactions();\n  }\n\n  updateUserInfo() {\n    const nameElement = document.getElementById('user-name');\n    const avatarElement = document.getElementById('user-avatar');\n    \n    if (this.user) {\n      if (nameElement) {\n        nameElement.textContent = `Welcome, ${this.user.first_name || 'User'}!`;\n      }\n      if (avatarElement) {\n        avatarElement.textContent = (this.user.first_name || 'U').charAt(0).toUpperCase();\n      }\n    } else {\n      if (nameElement) {\n        nameElement.textContent = 'Welcome back!';\n      }\n      if (avatarElement) {\n        avatarElement.textContent = 'U';\n      }\n    }\n  }\n\n  loadSampleTransactions() {\n    // Sample transactions for demo\n    this.transactions = [\n      {\n        id: 'tx1',\n        amount: 150.00,\n        bank_name: 'Dashen Bank',\n        receipt_number: 'DB12345',\n        created_at: Date.now() - 3600000,\n        status: 'completed'\n      },\n      {\n        id: 'tx2',\n        amount: 200.50,\n        bank_name: 'CBE',\n        receipt_number: 'CBE67890',\n        created_at: Date.now() - 7200000,\n        status: 'completed'\n      },\n      {\n        id: 'tx3',\n        amount: 75.25,\n        bank_name: 'Telebirr',\n        receipt_number: 'TB11223',\n        created_at: Date.now() - 10800000,\n        status: 'pending'\n      }\n    ];\n\n    this.renderTransactions();\n  }\n\n  renderTransactions() {\n    const container = document.getElementById('transactions-container');\n    if (!container) return;\n\n    if (this.transactions.length === 0) {\n      container.innerHTML = `\n        <div class=\"text-center py-8\">\n          <p class=\"text-gray-500\">No transactions yet</p>\n          <p class=\"text-sm text-gray-400\">Start capturing payments to see them here</p>\n        </div>\n      `;\n      return;\n    }\n\n    container.innerHTML = this.transactions.map(transaction => `\n      <div class=\"bg-white rounded-lg p-4 mb-3 shadow-sm border\">\n        <div class=\"flex items-center justify-between\">\n          <div class=\"flex items-center space-x-3\">\n            <div class=\"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center\">\n              <span class=\"text-white font-semibold text-sm\">${transaction.bank_name.charAt(0)}</span>\n            </div>\n            <div>\n              <div class=\"font-semibold text-gray-900\">${formatters.formatCurrency(transaction.amount)}</div>\n              <div class=\"text-sm text-gray-600\">${transaction.bank_name}</div>\n            </div>\n          </div>\n          <div class=\"text-right\">\n            <div class=\"text-xs text-gray-500\">${formatters.formatTimeAgo(transaction.created_at)}</div>\n            <div class=\"text-xs ${transaction.status === 'completed' ? 'text-green-600' : 'text-yellow-600'}\">\n              ${transaction.status}\n            </div>\n          </div>\n        </div>\n        <div class=\"mt-2 text-xs text-gray-500\">\n          Ref: ${transaction.receipt_number}\n        </div>\n      </div>\n    `).join('');\n  }\n\n  hideLoadingScreen() {\n    const loadingScreen = document.getElementById('loading-screen');\n    const app = document.getElementById('app');\n    \n    if (loadingScreen) {\n      loadingScreen.style.display = 'none';\n    }\n    \n    if (app) {\n      app.style.opacity = '1';\n    }\n  }\n\n  // Button handlers\n  handleCapturePayment() {\n    console.log('Capture payment clicked');\n    telegramService.sendData({\n      action: 'capture_payment',\n      user_id: this.user?.id\n    });\n    telegramService.showAlert('Opening payment capture...');\n  }\n\n  handleViewTransactions() {\n    console.log('View transactions clicked');\n    telegramService.sendData({\n      action: 'view_transactions',\n      user_id: this.user?.id\n    });\n    telegramService.showAlert('Loading transactions...');\n  }\n\n  handleUploadStatement() {\n    console.log('Upload statement clicked');\n    telegramService.sendData({\n      action: 'upload_statement',\n      user_id: this.user?.id\n    });\n    telegramService.showAlert('Opening statement upload...');\n  }\n\n  handleAnalytics() {\n    console.log('Analytics clicked');\n    window.location.href = 'analytics.html';\n  }\n\n  showHome() {\n    console.log('Home clicked');\n    // Reset to main view\n    this.updateUI();\n  }\n\n  showProfile() {\n    console.log('Profile clicked');\n    telegramService.showAlert('Profile feature coming soon!');\n  }\n}\n\n// Initialize the app when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', () => {\n  new VeriPayApp();\n});\n\n// Export for modules (if needed)\nwindow.VeriPayApp = VeriPayApp;\n"],"names":["telegramService","init","window","Telegram","WebApp","ready","expand","getUser","initDataUnsafe","user","sendData","data","JSON","stringify","showAlert","message","alert","formatters","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","format","formatTimeAgo","timestamp","now","Date","seconds","Math","round","minutes","hours","days","toLocaleDateString","VeriPayApp","constructor","this","transactions","setupEventListeners","updateUI","hideLoadingScreen","captureBtn","document","getElementById","transactionsBtn","uploadBtn","analyticsBtn","addEventListener","handleCapturePayment","handleViewTransactions","handleUploadStatement","handleAnalytics","homeBtn","transactionsNavBtn","profileBtn","showHome","showProfile","updateUserInfo","loadSampleTransactions","nameElement","avatarElement","textContent","first_name","charAt","toUpperCase","id","bank_name","receipt_number","created_at","status","renderTransactions","container","length","innerHTML","map","transaction","join","loadingScreen","app","display","opacity","action","user_id","_a","location","href"],"mappings":"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"}